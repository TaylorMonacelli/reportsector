Scripts to help me iterate on installing kubernetes using kubeadm in virtualbox on macos.

Following steps from https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm

When I screw up, I want to be able to start from scratch in order to eliminate variables.

I'm on a bad internet conection so I want to cache large files on virtualbox host and copy them to vm.

First install dependency shfmt from https://github.com/mvdan/sh#sh

next
#+begin_example
git clone https://github.com/TaylorMonacelli/reportsector
cd reportsector
#+end_example

next
#+begin_example
pip install reportsector
reportsector
# assert reportsector generated new cache.sh from template
ls ./cache.sh
#+end_example

next
#+begin_example
vagrant destroy --force &&
vagrant up &&
source .venv/bin/activate &&
reportsector &&
./cache.sh  &&
./vagrant_upload.sh &&
vagrant ssh --command 'sudo ./misc.sh' &&
vagrant ssh --command './install.sh' &&
vagrant ssh
#+end_example

next
#+begin_example
# validate that runc can run a container:
nerdctl run -it --rm alpine cat /etc/os-release
time sudo kubeadm config images pull --v=100 # takes 5m at starbucks, 30s at home
#+end_example

next
#+begin_example
sudo ./kubeadm-init.sh
mkdir -p $HOME/.kube
sudo cp /etc/kubernetes/admin.conf $HOME/.kube/config
sudo chown $(id -u):$(id -g) $HOME/.kube/config
kubectl get configmap/kubeadm-config -n kube-system -oyaml
kubectl cluster-info
#+end_example
